<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fa√ßa o login do seu gestor!</title>
    <link rel="stylesheet" href="cadastro-gestor.css" />

    <!-- LINK FONT INTER -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet" />
</head>

<body class="inter">
    <div class="container-geral flex inter">
        <div class="container-cadastro flex">
            <div class="box-cadastro flex">
                <h1 class="cadastrar-setor">Login do Gestor</h1>
                <div class="box-input-cadastro flex">
                    <input class="inter" type="text" id="input_emailGestor" placeholder="Email do Gestor" />
                    <input class="inter" type="text" id="input_senhaGestor" placeholder="Senha do Gestor" />

                </div>

                <div class="box-btn-cadastro flex">
                    <button class="inter" onclick="cadastroGestor()">Finalizar</button>
                </div>
            </div>
        </div>

        <div class="container-bem-vindo flex">
            <div class="logo flex">
                <img src="./assets/logo.png" alt="FluxSync" />
            </div>

            <h1 class="seja-bem-vindo">Seja bem-vindo!</h1>

            <button class="btn-saiba-mais inter" onclick="voltarHome()">Home</button>
        </div>
    </div>
</body>

</html>
<script>

    function cadastroGestor() {
        var emailGestor = input_emailGestor.value;
        var senhaGestor = input_senhaGestor.value;


        if (
            emailGestor == ''
            || senhaGestor == ''

        ) {
            mensagem_erro.innerHTML =
                "(Mensagem de erro para todos os campos em branco)";

            return false;
        } else {

            // Enviando o valor da nova input
            fetch("/usuarios/autenticarGestor", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    emailServer: emailGestor,
                    senhaServer: senhaGestor
                })
            }).then(function (resposta) {
                console.log("ESTOU NO THEN DO entrar()!")

                if (resposta.ok) {
                    console.log(resposta);

                    resposta.json().then(json => {
                        console.log(json);
                        console.log(JSON.stringify(json));
                        sessionStorage.EMAIL_USUARIO = json.email;
                        sessionStorage.NOME_USUARIO = json.nome;
                        sessionStorage.ID_USUARIO = json.id;

                        setTimeout(function () {
                            window.location = "./dashboard/cards.html";
                        }, 1000); // apenas para exibir o loading

                    });

                } else {

                    console.log("Houve um erro ao tentar realizar o login!");

                    resposta.text().then(texto => {
                        console.error(texto);
                    });
                }

            }).catch(function (erro) {
                console.log(erro);
            })

            return false;
        }
    }




</script>